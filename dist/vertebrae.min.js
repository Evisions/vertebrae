/*! Vertebrae v0.1.9 */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("vertebrae requires a window with a document");return b(a)}:"function"==typeof define&&define.amd?define("vertebrae",["jquery","backbone","underscore"],b):b(a)}("undefined"!=typeof window?window:this,function(a,b){var c=_.extend({camelCase:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},camelCaseFromNamespace:function(a){a=a.split(".");for(var b=0;b<a.length;b++)a[b]=c.camelCase(a[b]);return a.join("")},formatNumber:function(a){var b=String(a).split("."),c=b[0]||"0",d=b[1]||"",e=c.split("").reverse(),f=[],g="";if(c.length<=3)return String(a);while(e.length)f.push(e.splice(0,3).reverse().join(""));return g=f.reverse().join(","),d&&(g+="."+d),g},toLowerCase:function(a){return String(a).toLowerCase()},unescapeHTML:function(a){return $("<div/>").html(a).text()}});String.camelCase=function(){return c.camelCase.apply(String,arguments)},String.camelCaseFromNamespace=function(){return c.camelCaseFromNamespace.apply(String,arguments)},String.formatNumber=function(){return c.formatNumber.apply(String,arguments)},String.unescapeHTML=function(){return c.unescapeHTML.apply(String,[this])};var d=_.extend({},Backbone.Events),e={bindAll:function(a){var b=0,c=[],d=null,e;for(e in a)c.push(e);if(!a||!a.constructor)return a;for(b=0;b<c.length;++b)d=a[c[b]],_.isFunction(d)&&"constructor"!==c[b]&&_.contains(a.constructor.prototype,d)&&(a[c[b]]=_.bind(d,a));return a},fire:function(){return d.trigger.apply(d,arguments),e},trigger:function(){return e.fire.apply(e,arguments)},observe:function(a,b){return d.on.apply(d,arguments),{remove:function(){d.off(a,b)}}},on:function(){return e.observe.apply(e,arguments)}},f={createSuper:function(a,b){return function(){var c=this._super;this._super=a;var d=b.apply(this,arguments);return this._super=c,d}},createSuperForOverriddenFunctions:function(a,b){var c=_.keys(b),d=null,e=0;for(e=0;e<c.length;++e)if(d=c[e],_.isFunction(a[d])&&a[d]!==b[d]){if("constructor"==d)continue;b[d]=f.createSuper(a[d],b[d])}},createGettersAndSetters:function(a,b){var d=function(a,c){return this.set(b,a,c)},e=function(){return this.get(b)},g=c.camelCase(b);g.indexOf(".")>-1&&(g=c.camelCaseFromNamespace(g));var h="set"+g,i="get"+g;a[h]=_.isFunction(a[h])?f.createSuper(d,a[h]):d,a[i]=_.isFunction(a[i])?f.createSuper(e,a[i]):e},mergeClassProperty:function(a,b,c,d){var e=null;return _.isFunction(d)&&_.each(a[c],d),_.isArray(a[c])?(e=[],e=_.isArray(b[c])?e.concat(b[c],a[c]):e.concat(a[c])):_.isObject(a[c])&&(e={},_.isObject(b[c])?_.extend(e,b[c],a[c]):_.extend(e,a[c])),e&&(a[c]=e),a},setupInstanceEvents:function(a){if(_.isObject(a.events)){var b=_.keys(a.events),c=null,d=null,e=b.length,f=0;for(f=0;e>f;++f)if(c=b[f],d=a.events[c]){if(!a[d])throw new Error(d+" does not exist on this controller");a.listenTo(a,c,a[d])}}},setupInstanceObserves:function(a){if(_.isObject(a.observes)){var b=a.observes,c=_.keys(b),d=null,f=0,g=null;for(f=0;f<c.length;++f){if(d=c[f],g=b[d],!_.isFunction(a[g]))throw new Error(g+" does not exist for the global event "+d);a.once("unload",e.observe(d,_.bind(a[g],a)).remove)}}},makeFunction:function(a){return _.isFunction(a)?a:function(){}}},g=function(){this.initialize&&this.initialize.apply(this,arguments),this.trigger("init")};g.extend=function(a){var b=null;return f.mergeClassProperty(a,this.prototype,"properties",function(b){f.createGettersAndSetters(a,b)}),b=Backbone.View.extend.apply(this,arguments),f.createSuperForOverriddenFunctions(this.prototype,b.prototype),b},g.prototype={initialize:function(){},_super:function(){return this},applyProperties:function(a,b){var d=null,e=null;b=_.defaults(b||{},{replaceFunctions:!1});for(d in a)e=d.indexOf(".")>-1?"set"+c.camelCaseFromNamespace(d):"set"+c.camelCase(d),_.isFunction(this[e])?this[e](a[d]):(!_.isFunction(this[d])||b.replaceFunctions)&&(this[d]=a[d]);return this},destroy:function(){if(this.destroyed=!0,this.stopListening(),this.off(),_.isArray(this.properties)){var a=0,b=null;for(a=0;a<this.properties.length;a++)b=this.properties[a],this.set(b,null,!0)}},destroyProperties:function(){if(_.isArray(this.properties)){var a=0,b=null,c=null;for(a=0;a<this.properties.length;a++)c=this.properties[a],b=this.get(c),b&&_.isFunction(b.destroy)&&b.destroy()}},get:function(a){return a.indexOf(".")>-1?g.getPropertyByNamespace(this,a):this[a]},pick:function(){var a=_.toArray(arguments),b={},c=0,d=0,e=null,f=[];for(f=_.isArray(a[0])?a[0]:a,d=0,c=f.length;c>d;++d)e=f[d],b[e]=this.getter(e);return b},hasGetter:function(a){},getter:function(a){var b="get"+c.camelCase(a);return this[b].apply(this,_.toArray(arguments).slice(1))},setter:function(a){var b="set"+c.camelCase(a);return this[b].apply(this,_.toArray(arguments).slice(1))},getProperties:function(){var a={},b=this.properties||[],c=0,d=null,e=null,f=null;for(c=0;c<b.length;++c)f=b[c],d=this["get"+String.camelCase(f)],e=d?d.call(this):this.get(f),void 0!==e&&(a[f]=e);return a},set:function(a,b,c){var d=a.indexOf(".")>-1,e=h!=b&&c!==!0,f={trigger:e,deferred:!0},h=d?g.getPropertyByNamespace(this,a):this[a],i=this;return _.isObject(c)&&_.extend(f,c),f.deferred===!0&&b&&_.isFunction(b.promise)?(f.deferred=!1,$.when(b).then(function(b){i.set(a,b,f)})):(d?g.setPropertyByNamespace(this,a,b):this[a]=b,f.trigger&&(this.trigger("change:"+a,this),clearTimeout(this._changeTimeout),this._changeTimeout=setTimeout(function(){i.trigger("change")},0)),this)}},_.extend(g,{setPropertyByNamespace:function(a,b,c){b=b||"";var d=b.split("."),e=a,f=null,g=0;if(!(d.length<1)){for(g=0;g<d.length-1;++g)f=d[g],null==e[f]&&(e[f]={}),e=e[f];return f=d[d.length-1],e[f]=c,c}},getPropertyByNamespace:function(a,b){b=b||"";var c=b.split("."),d=a,e=null,f=0;if(c.length<1)return null;for(f=0;f<c.length;++f){if(e=c[f],null==d)return null;if(f===c.length-1)return d[e];d=d[e]}return null}}),_.extend(g.prototype,Backbone.Events);var h=function(a,b,c){var d=null,e=null;if(a)return b||(b=a.getView()),d=a.validators||{},e=_.chain(d).map(function(d,e){if(c&&!_.contains(c,e))return!0;var g=f.makeFunction(b[k(e)]),l=f.makeFunction(b[i(e)]),m=f.makeFunction(b[j(e)]),n="",o=!1;return n=g.call(b),o=h.validateValueWithMiddleware(n,e,d,a),o===!0?(m.call(b),!0):(l.call(b,o+""),!1)}).reject(function(a){return a}).value(),e.length?!1:!0};function i(a){return"show"+c.camelCase(a)+"Error"}function j(a){return"show"+c.camelCase(a)+"Success"}function k(a){return"get"+c.camelCase(a)}h.validateValueWithMiddleware=function(a,b,c,d){_.isFunction(c)?c=[c].concat($.makeArray(arguments).slice(2)):_.isArray(c)||(c=[]);var e=0,f=null,g=!1;for(e=0;e<c.length;++e)if(f=c[e],_.isString(f)&&(f=d[f]),g=f.call(d,a,b),g!==!0)return g;return!0},h.validators={},h.validators.checkLength=function(a,b,c,d){return function(e,f){if(String(e)===e){if(e.length<a)return c||"This field must be a minimum length of "+a+".";if(e.length>b)return d||"This field cannot have a length greater than "+b+"."}return!0}},h.validators.email=function(a){return function(b,c){var d=/[a-z0-9!#$%&\'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&\'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+(?:[A-Z]{2}|com|org|net|gov|mil|biz|info|mobi|name|aero|jobs|museum|edu)\b/i;return b?d.test(b)?!0:a||"An invalid email address was entered.":!0}},h.validators.phone=function(a){return function(b,c){var d=/\(?([0-9]{3})\)?([ .-]?)([0-9]{3})\2([0-9]{4})/;return b?d.test(b)?!0:a||"An invalid phone number was entered.":!0}},h.validators.postalCode=function(a){return function(b,c){var d=/^\d{5}(-\d{4})?$/g;return b?d.test(b)?!0:a||"An invalid postal code was entered.":!0}},h.validators.empty=function(a){return function(b,c){return String(null==b?"":b).trim()?!0:a||"This field cannot be empty."}},h.validators.date=function(a){return a=a||"This is an invalid date.",function(b,c){if(_.isDate(b))try{var d=b.getTime();if(_.isNaN(d))return a}catch(e){return a}return!0}},h.validators.number=function(a){return a=a||"This is an invalid number.",function(b,c){return String(b).length>0&&_.isNaN(Number(b))?a:b%1!=0?"Decimal points are not allowed.":!0}},h.validators.numberBetween=function(a,b,c){return c=c||"This is an invalid number.",function(d,e){return String(d).length>0&&_.isNaN(Number(d))?c:d%1!=0?"Decimal points are not allowed.":a>d||d>b?c:!0}};var l=g.extend({properties:["view"],events:{"view:ready":"render","view:available":null},initialize:function(a){if(this._unbind=[],f.setupInstanceObserves(this),f.setupInstanceEvents(this),this.setupView(),!this.getView())throw new Error("A view was not properly assigned.");this.listenToOnce(this.getView(),"change:available",function(){this.trigger("view:available"),this.viewIsAvailable()})},sync:function(a,b){var d=null,e=this,f=null,g=!1,h=c.camelCase(a),i=void 0,j=null,k=null,l=null,m=null,n=null,o=null;return b=_.defaults(b||{},{trigger:!1,accessor:"get"+h,target:this,targetHandler:a+"DidChange",viewHandler:"refresh"+h+"PropertyOnView",view:this.getView()}),f=b.view,m=b.accessor,d=b.targetHandler,o=b.viewHandler,n=b.target,j=function(){return n[m]?n[m]():n.get(a)},k=function(a){g||(g=!0,e.listenToOnce(f,"change:available",function(){g=!1,l(a)}))},l=function(a){e[o]&&(f.getAvailable()?e[o](j(),a):k(a))},this.listenTo(n,"change:"+a,function(){var a=j();this[d]&&this[d](a,i),i=a,l(i)}),l(),b.trigger===!0&&this.trigger("change:"+a),this},destroy:function(){this._unloaded!==!0&&this.unload(),this.trigger("destroy"),this.destroyView(),this._super.apply(this,arguments)},destroyView:function(){var a=this.getView();a&&a.destroy(),this.setView(null)},setupView:function(){if(!this.view)throw"'setupView' needs to be overridden";this.setView(new this.view)},setup:function(a,b){return b=_.defaults(b||{},{delegate:this}),this.getView().setElement(a),this.getView().setDelegate(b.delegate),this.getView().watchDelegateProperties(),this.trigger("setup"),this.trigger("view:ready"),this.viewIsReady(),this},viewIsReady:function(){},render:function(){this.getView().render(),this.getView().setRendered()},viewIsAvailable:function(){},unload:function(a){if(this._unloaded!==!0){var b=this._unbind||[],c=null;while(b.length>0)b.pop().call(this);this._unloaded=!0,this.trigger("unload"),this.getView().unload(a)}},validate:function(){return!0},when:function(){return $.when.apply($,arguments)}});l.extend=function(a){return f.mergeClassProperty(a,this.prototype,"observes"),f.mergeClassProperty(a,this.prototype,"events"),_.isObject(a.validators)&&!_.isFunction(a.validate)&&(a.validate=function(a,b){return h(this,b,a)}),g.extend.apply(this,arguments)};var m={},n=Backbone.View.extend({rendered:!1,hidden:!1,available:!1,initialize:function(){e.bindAll(this);var a=this.initialize;this.initialize=null,g.call(this),this.initialize=a,this.listenTo(this,"change:hidden",this.refreshAvailable),this.listenTo(this,"change:rendered",this.refreshAvailable)},destroy:function(){this._super.apply(this,arguments),this.undelegateEvents(),this.$el.empty(),this.$el=null,this.el=null},getDelegate:function(){return this.delegate},getElementDatum:function(a){return this.constructor.datum($(a).closest(".__data__").get(0))},refreshAvailable:function(){this.setAvailable(this.isAvailable()?!0:!1)},whenAvailable:function(){var a=$.Deferred();return this.getAvailable()?a.resolve(this):this.listenToOnce(this,"change:available",function(){a.resolve(this)}),a.promise()},isAvailable:function(){return this.isRendered()&&!this.isHidden()?!0:!1},getAvailable:function(){return this.get("available")},setAvailable:function(a,b){return this.set("available",a,b),this},setRendered:function(){return this.set("rendered",!0),this},isRendered:function(){return!!this.getRendered()},setHidden:function(a,b){return this.set("hidden",a,b),this},isHidden:function(){return!!this.getHidden()},getHidden:function(){return this.get("hidden")},getRendered:function(){return this.get("rendered")},render:function(){},renderFragment:function(a,b,c){var d=$(document.createDocumentFragment()),e=document.createElement("div");return d.append(this.constructor.template(a,b)),c&&this.constructor.datum(d.children().get(0),b),d},renderFragments:function(a,b,c){var d=$(document.createDocumentFragment()),e=null,f=null,g=0;for(g=0;g<b.length;++g)context={index:g,first:0===g,last:g===b.length-1,even:g%2===0,odd:null},context.odd=!context.even,e=$(this.constructor.template(a,b[g],{data:context})),c&&this.constructor.datum(e.get(0),b[g]),d.append(e);return d},setDelegate:function(a){return this.delegate=a,this},template:function(a,b,c){return _.isString(a)||(c=b,b=a,a=this.templateName),_.isArray(b)?this.renderFragments(a,b,c):this.renderFragment(a,b,c)},unload:function(a){this.$el.empty(),_.isFunction(a)&&a()},watchDelegateProperties:function(){}}),o=g.extend(n.prototype);o.setup=function(a,b){a instanceof $&&(a=a.get(0));var c=new this({el:a});return c.setDelegate(b),c.watchDelegateProperties(),c},o.datum=function(a,b){return a?(a instanceof $&&(a=a.get(0)),2==arguments.length&&(a.__data__=b,$(a).addClass("__data__")),a.__data__):void 0},o.getTemplates=function(){return m||{}},o.setupTemplates=function(a){_.isObject(a)&&(m=a)},o.template=function(a,b,c){var d=m[a];return d?d(b||{},c):""},o.hasTemplate=function(a){return m[a]?!0:!1},o.templateExists=o.hasTemplate,o.extend=function(a){return _.each(a.events,function(b,c){if(String(b).indexOf(".")>-1){var d=b.split(".");a.events[c]=function(){var a=g.getPropertyByNamespace(this,b),c=g.getPropertyByNamespace(this,d.slice(0,-1).join("."));return a.apply(c,arguments)}}}),_.isObject(a.events)&&!a.overrideEvents&&_.isObject(this.prototype.events)&&(a.events=_.extend({},this.prototype.events,a.events)),_.isObject(a.templates)&&(_.isObject(this.prototype.templates)&&(a.templates=_.extend({},this.prototype.templates,a.templates)),_.each(a.templates,function(b,c){_.isFunction(a[b])||(a[b]=function(a,b){return this.template(c,a,b)})})),g.extend.apply(this,arguments)};var p=/\((.*?)\)/g,q=/(\(\?)?:\w+/g,r=/\*\w+/g,s=/[\-{}\[\]+?.,\\\^$|#\s]/g,t=g.extend({initialize:function(a){return _.isFunction(this.defaults)&&(a=_.defaults(_.clone(a),this.defaults())),this.applyProperties(a),this._super()},updateWith:function(a){return this.applyProperties(a.getProperties()),this},when:function(){return $.when.apply($,arguments)},toJSON:function(){var a={};return this.serverProperties&&this.serverProperties.length&&(a=_.pick(this,this.serverProperties)),a}},{timeout:3e4,parsers:{},rootURI:"/",defaultHandler:function(a){return a},model:function(a){return new this(a)},models:function(a){var b=[],c=(a||[]).length,d=0;for(d=0;c>d;++d)b.push(this.model(a[d]));return b},getAjaxTimeout:function(){return Number(this.timeout)||500},request:function(a,b,c){c||(c={}),b||(b={});var d=this,e=this.getResponseDefaults(),f=(this.rootUrl||this.rootURI)+a;return _.defaults(c,{data:b,url:f}),c.timeout=this.getAjaxTimeout(),c.jsonBody&&(c.contentType="application/json",c.data=JSON.stringify(c.data),c.processData=!1),this.ajax(c).then(function(f,g,h){if(e&&(f=_.defaults(f||{},e)),d.isValidResponse(f,g,h)){var i=d.getParser(a,c.type)||d.defaultHandler;return d.resolve(i.call(d,d.getResponseSuccessPayload(f||{}),b)||{},b,f)}return d.reject(d.getResponseFailPayload(f||{}))},function(a){return a.url=f,a.methodType=c.type,a})},ajax:function(a){var b=$.Deferred();return a.success=b.resolve,a.error=b.reject,Backbone.ajax(a),b.promise()},reject:function(a){return $.Deferred.reject(a)},resolve:function(a,b,c){return $.Deferred().resolve(a,b,c)},isValidResponse:function(a){return!!a},getResponseDefaults:function(){return null},getResponseSuccessPayload:function(a){return a},getResponseFailPayload:function(a){return a},getParser:function(a,b){var c=this._parsers||[],d=c.length,e=0,f=null;for(b=String(b).toLowerCase(),e=0;d>e;++e)if(f=c[e],(!f.type||f.type===b)&&f.uri.test(a))return f.callback},post:function(a,b,c){return this.request(a,b,_.defaults(c||{},{type:"POST"}))},get:function(a,b,c){return this.request(a,b,_.defaults(c||{},{type:"GET"}))},put:function(a,b,c){return this.request(a,b,_.defaults(c||{},{type:"PUT",jsonBody:!0}))},del:function(a,b,c){return this.request(a,b,_.defaults(c||{},{type:"DELETE"}))},generateLink:function(a){return window.location.protocol+"//"+window.location.host+this.rootURI+a}});function u(a){var b={},d=null,e=["POST","GET","PUT","DEL"],f=null;return f={POST:"requestCreate",GET:"requestOne",PUT:"requestUpdate",DEL:"requestDelete"},d=function(a,g){var h=String(g).trim().split(/\s+/),i=String(h[0]).trim().toLowerCase(),j=h.slice(1).join("");if("delete"==i)i="del";else if("crud"==i)return void _.each(e,function(b){var e=b+" "+j;switch(b){case"GET":e+="/:$0";break;case"PUT":case"DEL":e+="/:id"}d(f[b]+c.camelCase(a),e)});b[a]=function(a,b){var c=arguments,d=0,b=null,e=_.clone(a),f=String(j).replace(/:[\$]?\w+/g,function(a){var b=a.slice(1),f=null;if("$"==b[0])return f=c[d++];if(e&&e[b])return f=e[b],delete e[b],f;throw new Error("The route "+g+" must include "+b+" in your params")});return e=_.clone(c[d++])||{},b=_.clone(c[d])||{},this[i](f,e,b)}},_.each(a,d),b}function v(a){var b=a.rootURI;return _.map(a.parsers||{},function(a,b){var c=b.split(/\s+/),d=c.length>1,e=d?String(c[0]).trim().toLowerCase():null,b=d?c.slice(1).join(""):c.join("");if("#"==b[0]){var f=b.slice(1).indexOf("#")+1;e=b.slice(1,f).toLowerCase(),b=b.slice(f+1)}if(b=b.replace(s,"\\$&").replace(p,"(?:$1)?").replace(q,function(a,b){return b?a:"([^/]+)"}).replace(r,"(.*?)"),_.isString(a)){var g=a;a=function(){return this[g].apply(this,arguments)}}return{uri:new RegExp("^"+b+"$"),callback:a,type:e}})}t.extend=function(a,b){this.parsers&&b&&b.parsers&&(b._parsers=v(b).concat(this._parsers||[])),b&&b.routes&&_.extend(b,u(b.routes));var c=[],d=[];return _.isArray(a.serverProperties)&&(c=a.serverProperties,_.isArray(a.properties)&&(d=a.properties),a.properties=[].concat(c,d)),g.extend.apply(this,arguments)};var w=g.extend({properties:["activeRoute","contentController","options","router"],routes:{},controllers:{},events:{start:"routing"},defaultRoute:"",initialize:function(a,b){f.setupInstanceEvents(this),this.$el=$(a),this.el=this.$el.get(0),this.setOptions(b||{}),this.initializeControllerMappings(),this._super.apply(this,arguments)},initializeControllerMappings:function(){var a=null,b=this.controllerMappings?this.controllerMappings.length:0,c=[],d=0;for(d=0;b>d;++d)a=_.clone(this.controllerMappings[d]),a.instance=new a.controller(this),a.name&&(this[a.name]=a.instance),c.push(a);return this.controllerMappings=c,this},setupControllerMappings:function(){var a=null,b=$.when(),c=null,d=this.controllerMappings?this.controllerMappings.length:0,e=0;for(e=0;d>e;++e)a=this.controllerMappings[e],c=a.instance,c.setup(this.$(a.selector)),c.start&&(b=$.when(b,c.start()));return b},navigate:function(a,b){return this.getRouter().navigate.apply(this,arguments),a},getHash:function(){return Backbone.history.getHash()},hideController:function(){},unloadController:function(){var a=this.getContentController();return a&&a.unload()},destroyController:function(){var a=this.getContentController();return a&&a.destroy()},showLoading:function(){},hideLoading:function(){},getContentElement:function(){if(this.content)return this.$(this.content);if(0==this.controllerMappings.length)return this.$el;throw new Error('You must specific the "content" property when using the "controllers" property.')},$:Backbone.View.prototype.$,getInitialRoute:function(){return this.defaultRoute},getControllerPath:function(a){return a},initializeController:function(a){var b=new a,c=b.name||b.contentName,d=this.getContentElement(),e=this._originalClasses||(this._originalClasses=d.attr("class")||" ");return d.empty().removeClass().addClass(e),_.isString(c)&&(c=c.replace(/[\s_]+/g,"-"),d.addClass(c)),_.isString(b.id)&&d.attr("id",b.id),b.setup(d),b},setupRoutes:function(){var a={},b=null,c=null;if(!this.routes)return this;for(b in this.routes)a[b]=this.generateRouteHandler(b,this.routes[b]);return c=new Backbone.Router({routes:a}),this.setRouter(c),this},canLeaveContentController:function(){return!0},canLoadContentController:function(a){return!0},generateRouteHandler:function(a,b){var c=null,d=this;return c=function(){var c=null,e=null,f=arguments,g=this.getActiveRoute(),h=$.Deferred(),i=$.when(d.currentRouteDeferred).then(null,function(){return $.Deferred().resolve()});return d.currentRouteDeferred=e=$.when(d.canLeaveContentController()).then(function(){return d.showLoading(),_.isString(b)?require([d.getControllerPath(b)],function(a){b=a,h.resolve()}):h.resolve(),i},function(){return a!=g&&d.navigate(g),w.RouteErrors.CANCELLED}).then(function(){return h}).then(function(){return d.canLoadContentController(b)?void 0:$.Deferred().reject(w.RouteErrors.DENIED)}).then(function(){return d.setActiveRoute(a),d.trigger("route",a),d.hideController()}).then(function(){return d.showLoading(),d.unloadController()}).then(function(){return d.destroyController()}).then(function(){return c=d.initializeController(b),d.setContentController(c),d.trigger("init:contentController",c),c.start?c.start.apply(c,f):void 0}).then(function(){c.trigger("data:ready"),d.trigger("start:contentController",c)}).always(function(){d.hideLoading()}).fail(function(a){switch(a){case w.RouteErrors.CANCELLED:return;case w.RouteErrors.DENIED:return}var b=d.routeDidFail(d.getHash(),f);d.setActiveRoute(null),b!==!0&&d.navigate(g||d.defaultRoute,{trigger:!0})})},$.proxy(c,this)},routeDidFail:function(){},start:function(){this.render();var a=this.setupControllerMappings();return this.setupRoutes(),this.trigger("start"),a},routing:function(){Backbone.history.start()||this.navigate(this.getInitialRoute(),{trigger:!0,replace:!0})},render:function(){return _.isString(this.template)?this.$el.html(o.template(this.template,this.getOptions())):_.isFunction(this.template)&&this.$el.html(this.template(this.getOptions())),this}},{RouteErrors:{CANCELLED:"cancelled",DENIED:"denied"},launch:function(a,b){var c=new this(a,b);return c.start(),c}});w.extend=function(a){var b=_.isArray(a.controllerMappings)?a.controllerMappings:[];return _.each(a.controllers,function(a,c){var d=String(c).trim().split(/\s+/),e=d.length>1?d[0]:null,f=e?d.slice(1).join(""):d.join("");e&&f&&b.push({selector:f,name:e,controller:a})}),a.controllerMappings=b,f.mergeClassProperty(a,this.prototype,"events"),f.mergeClassProperty(a,this.prototype,"controllerMappings"),g.extend.apply(this,arguments)};var x={Object:g,App:w,Controller:l,View:o,Model:t,Event:e,String:c,Utils:f,Validator:h},y=a.Vertebrae,z=a.V;return x.noConflict=function(b){return a.V===x&&(a.V=z),b&&a.Vertebrae===x&&(a.Vertebrae=y),x},"undefined"==typeof b&&(a.Vertebrae=a.V=x),x});
//# sourceMappingURL=vertebrae.min.map